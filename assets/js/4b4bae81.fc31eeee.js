"use strict";(self.webpackChunkdocs_new=self.webpackChunkdocs_new||[]).push([[976],{5932:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>p,frontMatter:()=>l,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"self-hosting","title":"Self-Hosting","description":"Step-by-step guide for running drasyl on your own infrastructure.","source":"@site/docs/self-hosting.md","sourceDirName":".","slug":"/self-hosting","permalink":"/self-hosting","draft":false,"unlisted":false,"editUrl":"https://github.com/drasyl/docs.drasyl.org/blob/master/docs/self-hosting.md","tags":[],"version":"current","lastUpdatedAt":1755457533000,"frontMatter":{"title":"Self-Hosting","description":"Step-by-step guide for running drasyl on your own infrastructure.","pagination_prev":null,"pagination_next":null},"sidebar":"tutorialSidebar"}');var t=s(4848),i=s(8453);const l={title:"Self-Hosting",description:"Step-by-step guide for running drasyl on your own infrastructure.",pagination_prev:null,pagination_next:null},a="Self-Hosting drasyl",o={},d=[{value:"Requirements",id:"requirements",level:2},{value:"Installation",id:"installation",level:2},{value:"Step 1: Build drasyl-sp",id:"step-1-build-drasyl-sp",level:3},{value:"Step 2: Install the binary",id:"step-2-install-the-binary",level:3},{value:"Step 3: Create system user",id:"step-3-create-system-user",level:3},{value:"Step 4: Secure configuration directory",id:"step-4-secure-configuration-directory",level:3},{value:"Step 5: Create service",id:"step-5-create-service",level:3},{value:"Step 6: Enable and start the service",id:"step-6-enable-and-start-the-service",level:3},{value:"Running multiple super peers",id:"running-multiple-super-peers",level:2},{value:"Configure drasyl to use your super peer(s)",id:"configure-drasyl-to-use-your-super-peers",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"self-hosting-drasyl",children:"Self-Hosting drasyl"})}),"\n",(0,t.jsx)(n.p,{children:"drasyl is released under a permissive open-source license, which explicitly grants you the rights to run, modify, and deploy the software on your own infrastructure. This enables full control over your drasyl deployment and makes it suitable for environments where using our public super peers is either unwanted or restricted by governance policies."}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"../concepts/networks#configuration-distribution",children:"Since drasyl works without a centralized network controller"}),", the only infrastructure component you need to operate yourself is at least one super peer. Super peers handle the signaling process that allows SDN devices to establish direct peer-to-peer connections over the underlying ",(0,t.jsx)(n.a,{href:"../architecture/p2p-protocol",children:"P2P network"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,t.jsx)(n.p,{children:"Super peers primarily assist in peer discovery and connection setup. They are rarely involved in actual data transfer and only relay traffic when a direct connection cannot be established. As a result, system requirements are minimal."}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Recommended Platform"}),": A Linux-based virtual machine. While other platforms may work, we have no production experience outside of Linux."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"CPU & RAM"}),": 1 vCPU and 1 GB of RAM are sufficient to handle several thousand concurrent nodes. As a rule of thumb, estimate ~16 MB of RAM and ~40 KB/s bandwidth per 1000 concurrent nodes."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Disk Usage"}),": Negligible. The super peer is stateless except for its identity file. Logs may require a few hundred MB depending on verbosity."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Network"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Low latency improves the setup time for direct peer-to-peer connections."}),"\n",(0,t.jsx)(n.li,{children:"High  bandwidth capacity is important if the super peer is expected to relay traffic."}),"\n",(0,t.jsx)(n.li,{children:"The server should be reachable via public IPv4 and IPv6 addresses to ensure global connectivity."}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Ports"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Signaling:"})," ",(0,t.jsx)(n.code,{children:"22527/UDP"})," (default; used for connection setup between peers)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Fallback when UDP is blocked:"})," ",(0,t.jsx)(n.code,{children:"443/TCP"})," (default; often the most promising option to bypass restrictive firewalls)."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsx)(n.p,{children:"Follow these steps to set up a drasyl super peer server."}),"\n",(0,t.jsx)(n.h3,{id:"step-1-build-drasyl-sp",children:"Step 1: Build drasyl-sp"}),"\n",(0,t.jsxs)(n.p,{children:["First, build the ",(0,t.jsx)(n.code,{children:"drasyl-sp"})," binary from source:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cargo build --package drasyl-sp --release --features prometheus\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-2-install-the-binary",children:"Step 2: Install the binary"}),"\n",(0,t.jsx)(n.p,{children:"Copy the built binary to the system path:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cp target/release/drasyl-sp /usr/local/sbin/\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-3-create-system-user",children:"Step 3: Create system user"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"useradd --system --create-home --home-dir /etc/drasyl-sp --shell /bin/false drasyl-sp\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-4-secure-configuration-directory",children:"Step 4: Secure configuration directory"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"chmod 700 /etc/drasyl-sp\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-5-create-service",children:"Step 5: Create service"}),"\n",(0,t.jsxs)(n.p,{children:["Each super peer must be assigned a ",(0,t.jsx)(n.code,{children:"DRASYL_NETWORK_ID"}),", which identifies the P2P network it belongs to. All super peers intended to operate within the same drasyl P2P network must use the same ",(0,t.jsx)(n.code,{children:"DRASYL_NETWORK_ID"})," value."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cat > /etc/systemd/system/drasyl-sp.service <<EOF\n[Unit]\nDescription=drasyl super peer\nAfter=network-online.target\n\n[Service]\nUser=drasyl-sp\nGroup=drasyl-sp\nType=simple\nAmbientCapabilities=CAP_NET_BIND_SERVICE\nEnvironment=DRASYL_NETWORK_ID=1234567890\nEnvironment=DRASYL_IDENTITY_FILE=/etc/drasyl-sp/drasyl-sp.identity\nEnvironment=DRASYL_TCP4_LISTEN=\nEnvironment=DRASYL_TCP6_LISTEN=[::]:443\nEnvironment=DRASYL_UDP4_LISTEN=\nEnvironment=DRASYL_UDP6_LISTEN=[::]:22527\nEnvironment=RUST_LOG=info\nExecStart=/usr/local/sbin/drasyl-sp\nRestart=on-failure\nRestartSec=5s\n\n[Install]\nWantedBy=default.target\nEOF\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-6-enable-and-start-the-service",children:"Step 6: Enable and start the service"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"systemctl enable drasyl-sp\nsystemctl start drasyl-sp\n"})}),"\n",(0,t.jsx)(n.p,{children:"Verify the service has started:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"journalctl -fu drasyl-sp\n"})}),"\n",(0,t.jsx)(n.p,{children:"You should see logs like:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Aug 16 10:10:05 sp drasyl-sp[1567]: Identity file '/etc/drasyl-sp/drasyl-sp.identity' not found. Generate new one...\nAug 16 10:10:22 sp drasyl-sp[1567]: Super peer listening on:\nAug 16 10:10:22 sp drasyl-sp[1567]:   udp://37.27.1.207:22527?publicKey=...&networkId=1234567890&tcpPort=443\nAug 16 10:10:22 sp drasyl-sp[1567]:   udp://[2a01:4f9:c013:422e::1]:22527?publicKey=...&networkId=1234567890&tcpPort=443\n"})}),"\n",(0,t.jsx)(n.p,{children:"The URLs listed above must be configured in your drasyl nodes (see configuration section below). For production use, it's recommended to configure a domain name with A/AAAA records pointing to your server instead of using the raw IP addresses directly."}),"\n",(0,t.jsx)(n.admonition,{title:"Important",type:"warning",children:(0,t.jsxs)(n.p,{children:["Back up ",(0,t.jsx)(n.code,{children:"/etc/drasyl-sp/drasyl-sp.identity"}),". This file contains the identity (including secret key) of your super peer and must persist across reboots or redeployments."]})}),"\n",(0,t.jsx)(n.h2,{id:"running-multiple-super-peers",children:"Running multiple super peers"}),"\n",(0,t.jsx)(n.p,{children:"You can operate multiple super peers to increase availability and reduce latency. Super peers are stateless and do not need to coordinate. This makes it easy to deploy them globally and achieve natural load balancing as node peers automatically connect to the nearest super peer."}),"\n",(0,t.jsx)(n.h2,{id:"configure-drasyl-to-use-your-super-peers",children:"Configure drasyl to use your super peer(s)"}),"\n",(0,t.jsxs)(n.p,{children:["To use your own super peer(s), configure the ",(0,t.jsx)(n.code,{children:"DRASYL_SUPER_PEERS"})," environment variable when starting the drasyl agent:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'DRASYL_NETWORK_ID=1234567890\nDRASYL_SUPER_PEERS="udp://<your-ip>:22527?publicKey=<your-public-key>&networkId=1234567890&tcpPort=443"\n'})}),"\n",(0,t.jsx)(n.p,{children:"Multiple super peers can be provided by separating them with commas."})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>a});var r=s(6540);const t={},i=r.createContext(t);function l(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);